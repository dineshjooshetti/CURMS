{% extends 'csmc/base.html' %}
{% block body %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'assets/timeline.css' %}" type="text/css">
    <style type="text/css">
        {#body,div,table,thead,tbody,tfoot,tr,th,td,p { font-family:"Arial"; }#}
        {#a.comment-indicator:hover + comment { background:#ffd; position:absolute; display:block; border:1px solid black; padding:0.5em;  } #}
        {#a.comment-indicator { background:red; display:inline-block; border:1px solid black; width:0.5em; height:0.5em;  } #}
        {#comment { display:none;  }#}
        .copo_td {
            border-top: 1px solid #000000;
            border-bottom: 1px solid #000000;
            border-left: 1px solid #000000;
            border-right: 1px solid #000000
        }
    </style>
    <style>
        .btn-cus-yellow {
            background-color: #F2C94C;
            border: 1px solid #ab903e;
            color: black;
            z-index: 99;
            font-size: 14px;
        }

        .nav-pills .nav-link.active, .nav-pills .show > .nav-link {
            background-color: #7f0000 !important;
        }

        .hover {
            color: #6b7480 !important;
        }

        .hover.active {
            color: white !important;
        }
    </style>
    <div class="header">
        <div class="container-fluid">
            <div class="header-body">
                <div class="row align-items-center py-4">
                    <div class="col-lg-8 col-7">
                        <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
                            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
                                <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
                                <li class="breadcrumb-item"><a href="/pcmi/pcmi_program_detail/{{ p_id }}">Program
                                    Structure</a></li>
                                <li class="breadcrumb-item" aria-current="page">Course Preview</li>
                            </ol>
                        </nav>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid mt-3">
        <div class="nav-wrapper">
            <ul class="nav nav-pills nav-fill flex-column flex-md-row" id="tabs-icons-text" role="tablist">
                <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0 hover active" id="tabs-icons-text-1-tab" data-toggle="tab"
                       href="#tabs-icons-text-1" role="tab" aria-controls="tabs-icons-text-1" aria-selected="true"><i
                            class="fa fa-file-alt mr-2"></i>COURSE PREVIEW</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0 hover" id="tabs-icons-text-2-tab" data-toggle="tab"
                       href="#tabs-icons-text-2" role="tab" aria-controls="tabs-icons-text-2" aria-selected="false"><i
                            class="far fa-comment-dots mr-2"></i>SUGGESTIONS & TIMELINE</a>
                </li>
            </ul>
        </div>
        <div class="card shadow">
            <div class="card-body">
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="tabs-icons-text-1" role="tabpanel"
                         aria-labelledby="tabs-icons-text-1-tab">

                        <div class="col-lg-12">
                            <div class="">
                                <div class="row">
                                    {% if course_edit == 1 %}
                                        <a class="btn btn-md mb-2" href="/pcmi/course_details/{{ course_id }}"
                                           style="  color: white;background-color: #9e9e9e;float: right">Edit</a>
                                    {% endif %}
                                </div>
                                <table border="1" style="font-size: 14px !important;margin-top:15px;" width="100%">
                                    <tr>
                                        <th rowspan="6"><img style="height: 100px;margin-left: 6px;margin-right: -9px;" src="/static/gitam-logo.jpg"></th>
                                        <th>Course Code</th>
                                        <th>Course Title</th>
                                        <th>L</th>
                                        <th>T</th>
                                        <th>P</th>
                                        <th>J</th>
                                        <th>S</th>
                                        <th>C</th>
                                    </tr>
                                    <tr>

                                        <td>XXXXXXXX</td>
                                        <td>{{ course.0.course_name }}</td>
                                        <td>{{ course.0.L }}</td>
                                        <td>{{ course.0.T }}</td>
                                        <td>{{ course.0.P }}</td>
                                        <td>{{ course.0.J }}</td>
                                        <td>{{ course.0.S }}</td>
                                        <td>{{ course.0.C }}</td>
                                    </tr>
                                    <tr>

                                        <td>Course Owner</td>
                                        <td>Department of Physics</td>
                                        <td colspan="4">Syllabus version</td>
                                        <td colspan="2">4.0</td>
                                    </tr>
                                    <tr>

                                        <td>Course Pre-requisite(s)</td>
                                        <td>{% if course_details.pre_requisites_yes1 %}{{ course_details.pre_requisites_yes1 }},{% endif %}{% if course_details.pre_requisites_yes2 %}{{ course_details.pre_requisites_yes2 }},{% endif %}{% if course_details.pre_requisites_yes3 %}{{ course_details.pre_requisites_yes3 }},{% endif %}{% if course_details.pre_requisites_yes4 %}{{ course_details.pre_requisites_yes4 }},{% endif %}{% if course_details.pre_requisites_yes5 %}{{ course_details.pre_requisites_yes5 }}{% endif %}</td>
                                        <td colspan="4">Contact hours</td>
                                        <td colspan="2">{{ course.0.total_no_of_contact_hours }}</td>
                                    </tr>
                                    <tr>

                                        <td>Course Co-requisite(s)</td>
                                        <td>{% if course_details.co_requisite1 %}{{ course_details.co_requisite1 }},{% endif %}{% if course_details.co_requisite2 %}{{ course_details.co_requisite2 }},{% endif %}{% if course_details.co_requisite3 %}{{ course_details.co_requisite3 }},{% endif %}{% if course_details.co_requisite4 %}{{ course_details.co_requisite4 }},{% endif %}{% if course_details.co_requisite5 %}{{ course_details.co_requisite5 }}{% endif %}</td>
                                        <td colspan="4">Date Approved</td>
                                        <td colspan="2">-</td>
                                    </tr>
                                    <tr>
                                        <td>Alternate Exposure</td>
                                        <td colspan="7">{{ course.0.alternative_exposure }}</td>
                                    </tr>
                                </table>
                                <p style="text-align: justify;margin-top:15px;">
                                    {{ course.0.course_descrption }}
                                </p>
                                <h4>Course Objectives</h4>
                                <div style="margin-left:30px;">
                                    {{ course.0.specific_instruction_objectives|linebreaks }}
                                </div>
                                {% for syllabus in course_syllabus %}
                                    <div class="row mt-3">
                                        <div class="col-md-12">
                                            <h4>
                                                <span style="float: left">Unit {{ forloop.counter }}&nbsp;&nbsp;&nbsp;&nbsp; {{ syllabus.short_title }}</span>
                                                <span style="float: right;margin-right: 40px;">{{ syllabus.number_of_contact_hours }}</span>
                                            </h4><br>
                                            <p style="text-align: justify">{{ syllabus.unit_name }}</p>
                                            <h5>Learning Outcomes</h5>

                                            <div style="margin-left:30px;">
                                                <span style="font-size:14px;">After completion of this unit, the student will be able to</span>
                                                <table style="font-size:14px !important;" width="100%">
                                                    <tr>
                                                        <td width="95%">
                                                            <li>{{ syllabus.outcome_1 }}</li>
                                                        </td>
                                                        <td><span>{{ syllabus.level_1 }}</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="95%">
                                                            <li>{{ syllabus.outcome_2 }}</li>
                                                        </td>
                                                        <td><span>{{ syllabus.level_2 }}</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="95%">
                                                            <li>{{ syllabus.outcome_3 }}</li>
                                                        </td>
                                                        <td><span>{{ syllabus.level_3 }}</span></td>
                                                    </tr>
                                                    {% if syllabus.outcome_4 %}
                                                        <tr>
                                                            <td width="95%">
                                                                <li>{{ syllabus.outcome_4 }}</li>
                                                            </td>
                                                            <td><span>{{ syllabus.level_4 }}</span></td>
                                                        </tr>
                                                    {% endif %}
                                                    {% if syllabus.outcome_5 %}
                                                        <tr>
                                                            <td width="95%">
                                                                <li>{{ syllabus.outcome_5 }}</li>
                                                            </td>
                                                            <td><span>{{ syllabus.level_5 }}</span></td>
                                                        </tr>
                                                    {% endif %}
                                                </table>
                                            </div>
                                            <div style="display: inline-flex;">
                                                <h5>Pedagogy tools:&nbsp;</h5>
                                                {% for p in pedagogy_tools %}
                                                    {% for j in syllabus.pedagogy_tools %}
                                                        {% if j.p_id == p.id %}
                                                            <span style="float: left;font-size: 14px;">{{ p.name }}
                                                                    {% if not syllabus.pedagogy_tools|length == forloop.counter %}
                                                                        ,&nbsp;{% endif %}</span>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% endfor %}
                                            </div>


                                        </div>
                                    </div>
                                {% endfor %}<br>
                                <h4>Texbook(s)</h4>
                                {% for j in course_book_details %}
                                    <div>
                                        <p>{{ forloop.counter }}.&nbsp;{{ j.author }},'{{ j.title }}',{{ j.edition }},{{ j.publisher }},{{ j.place_of_publication }},{{ j.year }},{{ j.isbn }},{{ j.unit_mapping }}</p>
                                    </div>
                                {% endfor %}
                                <h4>Additional Reading(s)</h4>
                                {% for i in references_details %}
                                    <div>
                                        <p>{{ forloop.counter }}.&nbsp;{{ i.author }},'{{ i.title }}',{{ i.edition }},{{ i.publisher }},{{ i.place_of_publication }},{{ i.year }},{{ i.isbn }},{{ i.unit_mapping }}</p>
                                    </div>
                                {% endfor %}
                                <h4>Journal(s)</h4>
                                {% for i in journal_details %}
                                    <div>
                                        <p>{{ forloop.counter }}.&nbsp;{{ i.author }},'{{ i.title }}',{{ i.year }},{{ i.pages }},{{ i.unit_mapping }}</p>
                                    </div>
                                {% endfor %}
                                <h4>Website(s)</h4>
                                {% for i in website_details %}
                                    <div>
                                        <p>{{ forloop.counter }}.&nbsp;{{ i.name_website }},{{ i.last_accessed }},{{ i.website_url }},{{ i.unit_mapping }}</p>
                                    </div>
                                {% endfor %}
                                <table id="table" border="1" width="100%">
                                    <thead class="text-center">
                                    <tr>
                                        <th scope="col"></th>
                                        <th colspan="12">POs</th>
                                        <th colspan="{{ pso|length }}">PSOs</th>
                                    </tr>
                                    </thead>
                                    <tr class="text-center">
                                        <th scope="col">CO</th>
                                        <th scope="col">1</th>
                                        <th scope="col">2</th>
                                        <th scope="col">3</th>
                                        <th scope="col">4</th>
                                        <th scope="col">5</th>
                                        <th scope="col">6</th>
                                        <th scope="col">7</th>
                                        <th scope="col">8</th>
                                        <th scope="col">9</th>
                                        <th scope="col">10</th>
                                        <th scope="col">11</th>
                                        <th scope="col">12</th>
                                        {% for p in pso %}
                                            <th scope="col">{{ forloop.counter }}</th>
                                        {% endfor %}
                                    </tr>
                                    </thead>
                                    <tbody class="text-center">
                                    <input type="hidden" name="courseid" value="{{ course_details.id }}">
                                    {% for k in co_po_pso %}
                                        <tr>
                                            <input type="hidden" name="co_po_pso_id" value="{{ k.id }}">
                                            <th scope="row">{{ forloop.counter }}</th>
                                            <td>{% if k.po.po1 %}{{ k.po.po1 }}{% endif %}</td>
                                            <td>{% if k.po.po2 %}{{ k.po.po2 }}{% endif %}</td>
                                            <td>{% if k.po.po3 %}{{ k.po.po3 }}{% endif %}</td>
                                            <td>{% if k.po.po4 %}{{ k.po.po4 }}{% endif %}</td>
                                            <td>{% if k.po.po5 %}{{ k.po.po5 }}{% endif %}</td>
                                            <td>{% if k.po.po6 %}{{ k.po.po6 }}{% endif %}</td>
                                            <td>{% if k.po.po7 %}{{ k.po.po7 }}{% endif %}</td>
                                            <td>{% if k.po.po8 %}{{ k.po.po8 }}{% endif %}</td>
                                            <td>{% if k.po.po9 %}{{ k.po.po9 }}{% endif %}</td>
                                            <td>{% if k.po.po10 %}{{ k.po.po10 }}{% endif %}</td>
                                            <td>{% if k.po.po11 %}{{ k.po.po11 }}{% endif %}</td>
                                            <td>{% if k.po.po12 %}{{ k.po.po12 }}{% endif %}</td>
                                            <td>{% if k.po.pso1 %}{{ k.po.pso1 }}{% endif %}</td>
                                            <td>{% if k.po.pso2 %}{{ k.po.pso2 }}{% endif %}</td>
                                            <td>{% if k.po.pso3 %}{{ k.po.pso3 }}{% endif %}</td>
                                            {% if not  k.po.pso4 == None %}
                                                <td>{% if k.po.pso4 %}{{ k.po.pso4 }}{% endif %}</td>
                                            {% endif %}

                                        </tr>
                                    {% endfor %}
                                    <tr>
                                        <th scope="row">Avg</th>
                                        {% for c in copo_average %}
                                            <td>{{ c }}</td>
                                        {% endfor %}
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="row">
                                    <div class="col-lg-6">
                                    <div class="card-header text-center" style="margin-bottom: -15px">
                                        <span style="font-size: 18px ;">Course Outcomes(COs)</span>
                                    </div>
                                    <div class="card"
                                         style="border: 2px solid #cccccc;padding: 10px;color: black; font-size: 13px;">
                                        {% for c in course_outcome %}
                                            <span>{{ forloop.counter }} &nbsp;{{ c.course_outcome }}</span>
                                        {% endfor %}
                                    </div>
                                    <div class="card-header text-center" style="margin-bottom: -15px">
                                        <span style="font-size: 18px ;">Program Specific Outcomes(PSOs)</span>
                                    </div>
                                    <div class="card"
                                         style="border: 2px solid #cccccc;padding: 10px;color: black; font-size: 13px;">
                                        {% for p in pso %}
                                            <span>{{ forloop.counter }}  &nbsp;{{ p.pso }}</span>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card-header text-center" style="margin-bottom: -15px">
                                        <span style="font-size: 18px ;">Program Objectives(POs)</span>
                                    </div>
                                    <div class="card"
                                         style="border: 2px solid #cccccc;padding: 10px;font-size: 13px;color: black;">
                                        <span>1  &nbsp;Engineering Knowledge</span>
                                        <span>2  &nbsp;Problem analysis</span>
                                        <span>3  &nbsp;Design/development of solutions</span>
                                        <span>4  &nbsp;Conduct investigations of complex problems</span>
                                        <span>5  &nbsp;Modern tool usage</span>
                                        <span>6  &nbsp;The engineer and society</span>
                                        <span>7  &nbsp;Environment and sustainability</span>
                                        <span>8  &nbsp;Ethics</span>
                                        <span>9  &nbsp;Individual or team work</span>
                                        <span>10  &nbsp;Communication</span>
                                        <span>11  &nbsp;Project management and finance</span>
                                        <span>12  &nbsp;Life-long Learning</span>
                                    </div>
                                </div>
                                </div>
                                <center><h3 class="mt-5" style="text-align: center;">Instructional Plan</h3></center>
                                {% if course_details.instruction_plan %}
                                    <embed src="/media/user/instruction_plan/{{ course_details.instruction_plan }}#toolbar=0"  type="application/pdf"  width="100%" height="600px" />
                                {% else %}
                                    <span>No file uploaded</span>
                                {% endif %}
                                <br>

                                {#                                    {{ course_syllabus }}#}

                                <div class="row" style="margin-left: 40%">
                                    {% if is_edit == 1 %}
                                        <div class="actions clearfix">
                                            <button id="forward"
                                                    class="btn btn-md btn-cus-yellow btn-sm mb-2 message_post">Approve
                                            </button>

                                            <button id="forward"
                                                    class="btn btn-md btn-cus-yellow btn-sm mb-2 deny_post">Suggestions
                                            </button>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="tab-pane fade show" id="tabs-icons-text-2" role="tabpanel"
                         aria-labelledby="tabs-icons-text-2-tab">
                        <h2 style="color:#7f0000;text-align: center">Timeline</h2>
                        <hr>
                        <!-- timeline -->
                        <div class="timeline">


                            {% for t in course_timeline %}
                                <div class="timeline__event  animated fadeInUp delay-1s timeline__event--type2">
                                    <div class="timeline__event__icon">
                                        <img src="
                                                {% if forloop.counter == 1 %}{{ t.to_user__image }}{% else %}{{ t.user__image }}{% endif %}"
                                             class="timeline-userimg">
                                    </div>
                                    <div class="timeline__event__date">
                                        {% if forloop.counter == 1 %}{{ t.created }}{% else %}{{ t.created }}{% endif %}
                                    </div>
                                    <div class="timeline__event__content" style="width:75%">
                                        <div class="timeline__event__title">
                                            {% if forloop.counter == 1 %}{{ t.to_user__first_name }} <br>
                                                <span style="font-size: 14px">
                                                {{ t.to_user_group__description }}{% else %}{{ t.user__first_name }}
                                                <br>
                                                <span style="font-size: 14px">{{ t.user_group__description }}</span>{% endif %}
                                            <span class="status">{% if forloop.counter == 1 %}
                                                <span>Pending</span>{% else %}
                                                {{ t.course_status_level__title }}{% endif %}</span>
                                            {#								<br>#}
                                            {#								<span class="designation">HOI  -VSP -GIT  -EECE</span>#}
                                        </div>
                                        {% if forloop.counter == 1 %}

                                        {% else %}
                                            <div class="timeline__event__description">
                                                <p>TO: {{ t.to_user__first_name }}
                                                    | {{ t.to_user_group__description }}</p>
                                                {% if t.comment %}
                                                    <p>{{ t.comment }}</p>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}


                        </div>
                        <!--- end timeline-->
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="modal fade" id="staticModal" tabindex="-1" role="dialog" aria-labelledby="staticModalLabel"
         aria-hidden="true"
         data-backdrop="static">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticModalLabel">Submit Confirmation</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="text-align: center">
                    <h3 style="color: black">Do you want to Approve Program Course..?</h3>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <form action="/pcmi/course_structure_approve/{{ course_id }}" method="POST">{% csrf_token %}
                        {#                        <input type="hidden" id="course_id" name="course_id" value="{{ course_id }}">#}
                        {#                            <input type="hidden" id="csmi_user_id" name="csmi_user_id" value="{{ program_assign_details.user_id }}">#}
                        {#                        <input type="hidden" name="path" value="{{request.path}}">#}
                        <input type="submit" class="btn btn-md" style="background-color: #7f0000;color: white;"
                               value="Submit">
                    </form>

                </div>
            </div>
        </div>
    </div>
    <!-- Modal pdf-->
    <div class="modal fade" id="modal02" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog  modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="w3-modal-content w3-animate-zoom">
                        <iframe id="frame" width="100%" height="600px"></iframe>
                        {#                        <embed id="frame"   type="application/pdf"  width="100%" height="600px" />#}
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                </div>
            </div>
        </div>
    </div>
    <!-- End Modal PDF -->

    <script>
        $(".message_post").click(function () {
            var str = this.id;
            $("#staticModal").modal('show')
        })
    </script>
    <!-- deny-modal -->
    <div class="modal fade" id="staticModal2" tabindex="-1" role="dialog" aria-labelledby="staticModalLabel"
         aria-hidden="true"
         data-backdrop="static">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticModalLabel">Submit Confirmation</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form action="/pcmi/course_structure_need_more/{{ course_id }}" method="POST">{% csrf_token %}
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <textarea class="form-control csmi_suggestions" placeholder="Enter your Suggestion....."
                                          rows="6" required name="csmi_message" id="csmi_message"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <input type="submit" class="btn btn-md" style="background-color: #7f0000;color: white;"
                               value="Submit">
                    </div>
                </form>


            </div>
        </div>
    </div>


    <script>
        $(".deny_post").click(function () {
            var str = this.id;
            $("#staticModal2").modal('show')
        })
        $(".csmi_suggestions").focus(function () {
            if (document.getElementById('csmi_message').value === '') {
                document.getElementById('csmi_message').value += '• ';
            }
        });
        $("#csmi_message").on("keyup", function (e) {
            e.preventDefault();
            e.stopPropagation();
            // debugger;
            var keycode = (e.keyCode ? e.keyCode : e.which);
            if (keycode == '13') {
                document.getElementById('csmi_message').value += '• ';
            }
            var txtval = document.getElementById('csmi_message').value;
            if (txtval.substr(txtval.length - 1) == '\n') {
                document.getElementById('csmi_message').value = txtval.substring(0, txtval.length - 1);

            }

        });
    </script>
    <script>
        function getExtension(filename) {
            return filename.split('.').pop().toLowerCase();
        }

        $(".preview").on("click", function () {
            var c = $(this).data('value');
            var extension = getExtension(c);
            switch (extension) {
                case 'pdf':

                    onClick_pdf(c);
                    $("#modal02").modal('show');
                    break;

            }
        });

        function onClick_pdf(element) {
            var str1 = "/media/user/instruction_plan/";
            var str2 = element;
            var res = str1.concat(str2);
            //window.open(res, "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400");
            document.getElementById("frame").src = res + "#toolbar=0";
        }
    </script>
    <!---assign-pab modal--->

{% endblock %}

